<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lunchly Soccer Stats - Players</title>
    <link rel="stylesheet" href="styles.css"> <!-- Using styles.css -->
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700;800&family=Open+Sans:wght@400;700;800&display=swap" rel="stylesheet">
    <!-- Favicon link -->
    <link rel="icon" type="image/png" href="favicon.png">
    <style>
        /* Specific styles for the stats page */
        body {
            padding: 20px; /* Add overall body padding for small screens */
            box-sizing: border-box;
        }
        .top-navigation {
            width: 100%;
            text-align: left; /* Align button to the left */
            margin-bottom: 20px; /* Space between button and header */
            padding-top: 10px; /* Ensure space from the top of the page */
            box-sizing: border-box;
        }

        /* Small button styling for navigation */
        .nav-button {
            background-color: var(--dark-blue);
            color: var(--white);
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            font-size: 1em; /* Smaller font for navigation */
            font-weight: 700;
            text-decoration: none;
            cursor: pointer;
            transition: background-color 0.3s ease;
            display: inline-block; /* Ensures padding and width are respected */
            min-width: 120px; /* Ensure a minimum touch target size */
            text-align: center; /* Center text within the button */
        }

        .nav-button:hover {
            background-color: var(--orange);
        }

        /* Ensure header and table remain centered below the nav button */
        .header {
            display: flex; /* Already flex, good for aligning logo and title */
            align-items: center;
            justify-content: center;
            margin-bottom: 30px;
            flex-wrap: wrap; /* Allow items to wrap on smaller screens */
            text-align: center; /* Center text if wrapped */
        }

        /* Responsive table wrapper */
        .table-responsive {
            overflow-x: auto; /* Allows horizontal scrolling for the table on small screens */
            width: 100%; /* Take full width */
            -webkit-overflow-scrolling: touch; /* Smooth scrolling on iOS */
        }

        table {
            min-width: 600px; /* Ensure table has a minimum width, so it scrolls if needed */
            width: 100%; /* Take full width of its container */
            border-collapse: collapse;
            margin-top: 20px;
            background-color: var(--white);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            border-radius: 8px;
            overflow: hidden;
        }

        th, td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid #ddd;
            font-size: 1.1em;
            white-space: nowrap; /* Prevent text from wrapping in table cells */
        }

        th {
            background-color: var(--dark-blue);
            color: var(--white);
            font-weight: 700;
            text-transform: uppercase;
        }

        tr:nth-child(even) {
            background-color: #f9f9f9;
        }

        tr:hover {
            background-color: #f1f1f1;
        }

        /* Styling for the credit text */
        .credit-text {
            /* Removed width: 100% to prevent it from spanning the entire page width */
            text-align: right; /* Align text to the right */
            position: absolute; /* Position relative to the viewport */
            top: 10px; /* 10px from the top */
            right: 10px; /* 10px from the right */
            left: auto; /* Ensure it doesn't stretch from left */
            font-size: 0.9em; /* Smaller font size */
            color: var(--dark-blue); /* Use the dark blue for consistency */
            padding: 10px; /* Some padding around the text */
            box-sizing: border-box; /* Include padding in width calculation */
            z-index: 10; /* Ensure it's above other content */
            white-space: nowrap; /* Prevent text wrapping if it's too long for its small space */
        }

        @media (max-width: 768px) {
            .credit-text {
                font-size: 0.7em; /* Even smaller on mobile */
                top: 5px;
                right: 5px;
                text-align: center; /* Center on small screens to prevent overflow */
                position: relative; /* Change to relative on small screens to flow with content */
                margin-bottom: 10px; /* Add space if it's relative */
            }
            .header img {
                height: 50px; /* Slightly smaller logo on mobile */
                margin-right: 10px;
            }
            .header h1 {
                font-size: 2em; /* Adjust title size */
            }
            th, td {
                padding: 10px 8px; /* Reduce padding in table cells */
                font-size: 0.9em; /* Adjust table font size */
            }
            .nav-button {
                font-size: 0.9em; /* Adjust nav button size */
                padding: 8px 15px;
            }
        }
    </style>
</head>
<body>
    <div class="credit-text">
        Made by Vishruth Pidatala
    </div>
    <div class="container">
        <!-- Button to go back to homepage -->
        <div class="top-navigation">
            <a href="index.html" class="nav-button">Back to Homepage</a>
        </div>

        <div class="header">
            <img src="logo.png" alt="ISL Logo"> <!-- Using logo.png -->
            <h1>STATS</h1>
        </div>

        <div class="table-responsive">
            <table>
                <thead>
                    <tr>
                        <th>Player</th>
                        <th>Goals</th>
                        <th>Assists</th>
                        <th>Matches Played</th>
                        <th>G/A</th>
                    </tr>
                </thead>
                <tbody id="stats-table-body">
                    <!-- This part will be filled in automatically by JavaScript -->
                </tbody>
            </table>
        </div>
        <div id="loading-message">Loading stats...</div>
    </div>

    <script>
        // **** IMPORTANT: This is YOUR Google Apps Script Web App URL ****
        // This URL is obtained after deploying your Google Apps Script as a web app with 'Anyone' access.
        const GOOGLE_APPS_SCRIPT_WEB_APP_URL = 'https://script.google.com/macros/s/AKfycby-0FCeBB2tDrSCRQoykTKQX84qGpPDwYqLExAnmg4yyM6UJ-6OFvT2cuOPtd22Yghi/execs'; 

        // This function fetches data from the Google Apps Script Web App, sorts it by G/A, and populates the table.
        async function loadPlayerStats() {
            const tableBody = document.getElementById('stats-table-body');
            const loadingMessage = document.getElementById('loading-message');

            tableBody.innerHTML = ''; // Clear old data to prepare for new data
            loadingMessage.style.display = 'block'; // Show "Loading..." message

            try {
                const response = await fetch(GOOGLE_APPS_SCRIPT_WEB_APP_URL);

                if (!response.ok) {
                    throw new Error(`HTTP error! Status: ${response.status}. Could not get stats from Web App.`);
                }

                // Parse the response as JSON (since Apps Script now serves JSON)
                const players = await response.json(); 

                if (players.length === 0) {
                    const newRow = tableBody.insertRow();
                    const cell = newRow.insertCell();
                    cell.colSpan = 5;
                    cell.textContent = "No player stats found in the Google Sheet.";
                    cell.style.textAlign = "center";
                    return;
                }

                // Sort the players array by G/A in descending order (highest G/A first)
                // Note: The property names (e.g., 'G/A') must match the headers in your Google Sheet exactly.
                players.sort((a, b) => b['G/A'] - a['G/A']); 

                // Now, populate the table with the sorted data
                players.forEach(playerData => {
                    const newRow = tableBody.insertRow(); 
                    newRow.insertCell().textContent = playerData['Player'];
                    newRow.insertCell().textContent = playerData['Goals'];
                    newRow.insertCell().textContent = playerData['Assists'];
                    newRow.insertCell().textContent = playerData['Matches Played'];
                    newRow.insertCell().textContent = playerData['G/A'];
                });

            } catch (error) {
                console.error("Error loading stats:", error);
                const newRow = tableBody.insertRow();
                const cell = newRow.insertCell();
                cell.colSpan = 5;
                cell.textContent = `Failed to load stats: ${error.message}. Please ensure the Google Apps Script Web App URL is correct and deployed as 'Anyone' access.`;
                cell.style.color = "red";
                cell.style.textAlign = "center";
            } finally {
                loadingMessage.style.display = 'none'; // Always hide the loading message when done
            }
        }

        document.addEventListener('DOMContentLoaded', loadPlayerStats);
    </script>
</body>
</html>
