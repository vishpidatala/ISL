
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>ISL Stats - Players</title>
    <link rel="stylesheet" href="styles.css" />
    <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@600;700&display=swap" rel="stylesheet" />
    <link rel="icon" type="image/png" href="logo.png">
</head>
<body>
    <div class="credit-text">Made by Vishruth Pidatala</div>
    <div class="container">
        <div class="top-navigation">
            <a href="index.html" class="nav-button">Back to Homepage</a>
        </div>

        <div class="header">
            <img src="logo.png" alt="ISL Logo" />
            <h1>STATS</h1>
        </div>

        <div class="table-responsive">
            <table>
               <thead>
                    <tr>
                        <th>Player</th>
                        <th>Matches Played</th>
                        <th>G/A</th>
                        <th>Average Match Rating</th>
                    </tr>
                </thead>
                <tbody id="stats-table-body">
                    <!-- Populated by JS -->
                </tbody>
            </table>
        </div>
        <div id="loading-message">Loading stats...</div>
    </div>

    <script>
        const GOOGLE_APPS_SCRIPT_WEB_APP_URL = 'https://script.google.com/macros/s/AKfycbx61E5ibfa7nzExFcfwQ4mtBEjd9u9aZva_9HvauCGlYw1XbC9c7o0gU_YvOJUg9vU_/exec';

        async function loadPlayerStats() {
            const tableBody = document.getElementById('stats-table-body');
            const loadingMessage = document.getElementById('loading-message');
            tableBody.innerHTML = '';
            loadingMessage.style.display = 'block';
            try {
                const response = await fetch(GOOGLE_APPS_SCRIPT_WEB_APP_URL);
                if (!response.ok) throw new Error('HTTP error ' + response.status);
                const players = await response.json();
                if (!players.length) {
                    const newRow = tableBody.insertRow();
                    const cell = newRow.insertCell();
                    cell.colSpan = 5;
                    cell.textContent = 'No player stats found in the Google Sheet.';
                    cell.style.textAlign = 'center';
                    return;
                }
                players.sort((a, b) => b['G/A'] - a['G/A']);
                players.forEach(player => {
                    const newRow = tableBody.insertRow();
                    newRow.insertCell().textContent = player['Player'];
                    newRow.insertCell().textContent = player['Matches Played'];
                    newRow.insertCell().textContent = player['G/A'];
                    newRow.insertCell().textContent = player['Average Match Rating'];
                });

                });
            } catch (error) {
                const newRow = tableBody.insertRow();
                const cell = newRow.insertCell();
                cell.colSpan = 5;
                cell.textContent = `Failed to load stats: ${error.message}. Please check your Google Apps Script URL.`;
                cell.style.color = 'red';
                cell.style.textAlign = 'center';
            } finally {
                loadingMessage.style.display = 'none';
            }
        }

        document.addEventListener('DOMContentLoaded', loadPlayerStats);
    </script>
</body>
</html>
