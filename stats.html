// Replace with your Google Script URLs
const SCRIPT_URLS = {
  season1: "https://script.google.com/macros/s/AKfycbx81I3wTiNT4n_Zfh41lhDZZ3tYZ05Cu_WnrGYPyj0HjBQrvZUg4NGSZTANgFMjUyJC/exec",
  season2: "https://script.google.com/macros/s/AKfycbxW-kbQgxuHkPMMNQy2P6xB2c82OSUA3BkDUHqmYuUeZKtHTORMfh3TLKbSUjsP-4mR/exec"
};

// Load stats from Google Sheets
async function loadStats(season) {
  document.getElementById("loading-message").style.display = "block";
  try {
    const response = await fetch(SCRIPT_URLS[season]);
    const data = await response.json();
    renderTable(data);
  } catch (error) {
    console.error("Fetch error:", error);
    alert("Failed to load stats.");
  } finally {
    document.getElementById("loading-message").style.display = "none";
  }
}

// Render the stats table
function renderTable(data) {
  const tableBody = document.querySelector("#stats-table tbody");
  tableBody.innerHTML = "";

  // Sort by G/A Per Game
  data.sort((a, b) => b.ga - a.ga);

  data.forEach((row, index) => {
    const tr = document.createElement("tr");

    // Crowns for top 3
    let crown = "";
    if (index === 0) crown = "ðŸ‘‘";       // Gold
    else if (index === 1) crown = "ðŸ¥ˆ";  // Silver
    else if (index === 2) crown = "ðŸ¥‰";  // Bronze

    tr.innerHTML = `
      <td>${crown} ${row.player}</td>
      <td>${row.matches}</td>
      <td>${row.ga}</td>
    `;

    tableBody.appendChild(tr);
  });
}

// Handle season switch
document.getElementById("seasonSelect").addEventListener("change", (e) => {
  loadStats(e.target.value);
  updateSeasonLabel(e.target.value);
});

function updateSeasonLabel(season) {
  const label = document.querySelector(".season-label");
  label.textContent = season === "season2" ? "Season 2" : "Season 1";
}

// Default load Season 2
loadStats("season2");
updateSeasonLabel("season2");
